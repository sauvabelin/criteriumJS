(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["resultats"],{"0a45":function(t,e,n){"use strict";n("ac6a"),n("55dd"),n("6762"),n("2fdb"),n("96cf");var r=n("3b8d"),i=n("d225"),s=n("b0b4"),u=n("308d"),a=n("6bb5"),c=n("2a88"),o=n("4e2b"),l=n("bd67"),f=n("c0d6"),d=n("17e1"),p=n("4b2f"),v=["nom","max","coefficient"],h=function(t){function e(){var t;return Object(i["a"])(this,e),t=Object(u["a"])(this,Object(a["a"])(e).call(this)),t.nom=null,t.max=null,t.coefficient=null,t}return Object(o["a"])(e,t),Object(s["a"])(e,[{key:"insert",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(c["a"])(Object(a["a"])(e.prototype),"insert",this).call(this);case 2:return t.next=4,e.findAll();case 4:case"end":return t.stop()}},t,this)}));function n(){return t.apply(this,arguments)}return n}()},{key:"getMax",value:function(){return parseInt(this.max,10)}},{key:"participantsPasEntres",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark(function t(){var e,n,r;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,d["f"].run("SELECT * FROM ".concat(d["c"]," p JOIN ").concat(d["e"]," c ON c.participantId = p.id WHERE c.posteId = ?"),[this.id]);case 2:return e=t.sent,n=e.filter(function(t){return null!==t.points}).map(function(t){return t.participantId}),t.next=6,p["a"].findAll();case 6:return r=t.sent,t.abrupt("return",r.filter(function(t){return!n.includes(t.id)}));case 8:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}()},{key:"getResultats",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,d["f"].run("SELECT * FROM ".concat(d["c"]," p JOIN ").concat(d["e"]," c ON c.participantId = p.id WHERE c.posteId = ?"),[this.id]);case 2:return e=t.sent,t.abrupt("return",e.sort(function(t,e){return parseInt(t.points,10)<parseInt(e.points,10)}).map(function(t){var e=p["a"].convert(t);return e.id=t.participantId,e.points=t.points,e}));case 4:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}()}],[{key:"findAll",value:function(){return Object(c["a"])(Object(a["a"])(e),"findAll",this).call(this).then(function(t){return f["a"].commit("cleanPostes"),t.forEach(function(t){f["a"].commit("addPoste",t)}),t})}}]),e}(l["a"]);h.table=d["d"],h.properties=v,e["a"]=h},"1cb7":function(t,e,n){var r=n("bf0b"),i=n("53e2"),s=n("07e3"),u=n("63b6"),a=n("f772"),c=n("e4ae");function o(t,e){var n,u,l=arguments.length<3?t:arguments[2];return c(t)===l?t[e]:(n=r.f(t,e))?s(n,"value")?n.value:void 0!==n.get?n.get.call(l):void 0:a(u=i(t))?o(u,e,l):void 0}u(u.S,"Reflect",{get:o})},"1d44":function(t,e,n){"use strict";var r=n("6039"),i=n.n(r);i.a},"268f":function(t,e,n){t.exports=n("fde4")},"2a88":function(t,e,n){"use strict";var r=n("268f"),i=n.n(r),s=n("8feb"),u=n.n(s),a=n("6bb5");function c(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=Object(a["a"])(t),null===t)break;return t}function o(t,e,n){return o="undefined"!==typeof Reflect&&u.a?u.a:function(t,e,n){var r=c(t,e);if(r){var s=i()(r,e);return s.get?s.get.call(n):s.value}},o(t,e,n||t)}n.d(e,"a",function(){return o})},"2f21":function(t,e,n){"use strict";var r=n("79e5");t.exports=function(t,e){return!!t&&r(function(){e?t.call(null,function(){},1):t.call(null)})}},3496:function(t,e,n){},"35ac":function(t,e,n){},"386d":function(t,e,n){"use strict";var r=n("cb7c"),i=n("83a1"),s=n("5f1b");n("214f")("search",1,function(t,e,n,u){return[function(n){var r=t(this),i=void 0==n?void 0:n[e];return void 0!==i?i.call(n,r):new RegExp(n)[e](String(r))},function(t){var e=u(n,t,this);if(e.done)return e.value;var a=r(t),c=String(this),o=a.lastIndex;i(o,0)||(a.lastIndex=0);var l=s(a,c);return i(a.lastIndex,o)||(a.lastIndex=o),null===l?-1:l.index}]})},"46b3":function(t,e,n){},4910:function(t,e,n){n("1cb7"),t.exports=n("584a").Reflect.get},5217:function(t,e,n){"use strict";var r=n("46b3"),i=n.n(r);i.a},"55dd":function(t,e,n){"use strict";var r=n("5ca1"),i=n("d8e8"),s=n("4bf8"),u=n("79e5"),a=[].sort,c=[1,2,3];r(r.P+r.F*(u(function(){c.sort(void 0)})||!u(function(){c.sort(null)})||!n("2f21")(a)),"Array",{sort:function(t){return void 0===t?a.call(s(this)):a.call(s(this),i(t))}})},6039:function(t,e,n){},"7bc5":function(t,e,n){"use strict";var r=n("c11f"),i=n.n(r);i.a},"83a1":function(t,e){t.exports=Object.is||function(t,e){return t===e?0!==t||1/t===1/e:t!=t&&e!=e}},"8a52":function(t,e,n){"use strict";var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{staticClass:"sub-menu"},[n("div",{staticClass:"sub-menu-header p-3 d-flex align-items-center"},[n("div",{staticClass:"icon-holder d-flex align-items-center justify-content-center",style:{background:t.color}},[n("icon",{attrs:{type:t.icon}})],1),n("div",{staticClass:"ml-2"},[n("h3",{staticClass:"m-0"},[t._v(t._s(t.title))]),n("h5",{staticClass:"m-0"},[t._v(t._s(t.subtitle))])])]),n("div",{staticClass:"pl-4"},[t._t("default",null,{hover:t.color})],2)])])},i=[],s=(n("805a"),n("0c63")),u={components:{Icon:s["a"]},props:["title","subtitle","icon","color"]},a=u,c=(n("c62a"),n("2877")),o=Object(c["a"])(a,r,i,!1,null,"56dcfbb6",null);e["a"]=o.exports},"8feb":function(t,e,n){t.exports=n("4910")},"9e13":function(t,e,n){"use strict";var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{staticClass:"container-fluid"},[n("div",{staticClass:"row mb-3"},[n("div",{staticClass:"col-12 col-md-2"},[t._v("\n                Filtrer par année\n                "),n("a-select",{staticStyle:{width:"100%"},model:{value:t.year,callback:function(e){t.year=e},expression:"year"}},[n("a-select-option",{attrs:{value:-1}},[t._v("Ne pas filtrer")]),t._l(t.annees,function(e){return n("a-select-option",{key:e,attrs:{value:e}},[t._v(t._s(e))])})],2)],1),n("div",{staticClass:"col-12 col-md-2"},[t._v("\n                Filtrer par unité\n                "),n("a-select",{staticStyle:{width:"100%"},model:{value:t.unit,callback:function(e){t.unit=e},expression:"unit"}},[n("a-select-option",{attrs:{value:-1}},[t._v("Ne pas filtrer")]),t._l(t.unites,function(e){return n("a-select-option",{key:e,attrs:{value:e}},[t._v(t._s(t.getUnite(e).nom))])})],2)],1),n("div",{staticClass:"col-12 col-md-2"},[t._v("\n                Filtrer par sous-unité\n                "),n("a-select",{staticStyle:{width:"100%"},model:{value:t.subUnit,callback:function(e){t.subUnit=e},expression:"subUnit"}},[n("a-select-option",{attrs:{value:-1}},[t._v("Ne pas filtrer")]),t._l(t.sousUnite,function(e){return n("a-select-option",{key:e,attrs:{value:e}},[t._v(t._s(t.getSousUnite(e).nom))])})],2)],1),n("div",{staticClass:"col-12 col-md-2"},[t._v("\n                Filtrer par branche\n                "),n("a-select",{staticStyle:{width:"100%"},model:{value:t.branche,callback:function(e){t.branche=e},expression:"branche"}},[n("a-select-option",{attrs:{value:-1}},[t._v("Ne pas filtrer")]),t._l(t.branches,function(e){return n("a-select-option",{key:e.nom,attrs:{value:e.bid}},[t._v(t._s(e.nom))])}),n("a-select-option",{attrs:{value:10}},[t._v("éclaireurs-euses")]),n("a-select-option",{attrs:{value:11}},[t._v("louveteaux-ettes")])],2)],1),n("div",{staticClass:"col-12 col-md-2"},[t._v("\n                Filtrer par sexe\n                "),n("a-select",{staticStyle:{width:"100%"},model:{value:t.xxx,callback:function(e){t.xxx=e},expression:"xxx"}},[n("a-select-option",{attrs:{value:-1}},[t._v("Ne pas filtrer")]),t._l(t.sexe,function(e){return n("a-select-option",{key:e,attrs:{value:e}},[t._v(t._s(e))])})],2)],1),n("div",{staticClass:"col-12 col-md-2"},[t._v("\n                Rechercher\n                "),n("a-input",{attrs:{placeholder:"Rechercher"},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1)])]),n("div",{class:{bordered:t.border}},[n("a-table",{attrs:{dataSource:t.participants,columns:t.cls,rowKey:"dossard",scroll:t.scroll},scopedSlots:t._u([{key:"moment",fn:function(e){return n("span",{},[t._v("("+t._s(e)+")")])}},{key:"unite",fn:function(e){return n("div",{},[t._v(t._s(e.unite().nom))])}},{key:"sousunite",fn:function(e){return n("div",{},[t._v(t._s(e.sousUnite().nom))])}},{key:"expandedRowRender",fn:function(e){return t.details?n("div",{},[n("participant-details",{attrs:{participant:e}})],1):t._e()}}],null,!0)})],1)])},i=[],s=(n("386d"),n("6762"),n("2fdb"),n("55dd"),n("02cf"),n("9839")),u=(n("a71a"),n("b558")),a=(n("0723"),n("0020")),c=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{staticClass:"row"},[n("div",{staticClass:"col-12 col-md-6"},[n("h3",[t._v("Résultats aux courses")]),n("table",{staticStyle:{width:"100%",background:"transparent"}},[t._m(0),t._l(t.$store.state.courses,function(e){return n("tr",{key:e.id},[n("td",[n("b",[t._v(t._s(e.nom))])]),t.crs(e.id)?n("td",[t._v(t._s(t._f("printDate")(t.crs(e.id).debut)))]):n("td",[t._v("-")]),t.crs(e.id)?n("td",[t._v(t._s(t._f("printDate")(t.crs(e.id).arrivee)))]):n("td",[t._v("-")]),n("td",[t._v(t._s(t._f("timeDiff")([t.crs(e.id).arrivee,t.crs(e.id).debut])))])])})],2)]),n("div",{staticClass:"col-12 col-md-6"},[n("h3",[t._v("Résultats aux postes")]),n("table",{staticStyle:{width:"100%",background:"transparent"}},[t._m(1),t._l(t.$store.state.postes,function(e){return n("tr",{key:e.id},[n("td",[n("b",[t._v(t._s(e.nom))])]),n("td",[t._v(t._s(t.pst(e.id)?t.pst(e.id).points:"Rien"))])])})],2)])])])},o=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("tr",[n("th",[t._v("Course")]),n("th",[t._v("Départ")]),n("th",[t._v("Arrivée")]),n("th",[t._v("Temps total")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("tr",[n("th",[t._v("Poste")]),n("th",[t._v("Nombre de points")])])}],l=(n("7514"),n("96cf"),n("3b8d")),f={props:["participant"],mounted:function(){var t=Object(l["a"])(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.participant.getPostesData();case 2:return this.postes=t.sent,t.next=5,this.participant.getCoursesData();case 5:this.courses=t.sent;case 6:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),data:function(){return{postes:[],courses:[]}},methods:{tempsTotal:function(t){var e=this.crs(t);return null===e||null===e.debut||null===e.arrivee?null:e.arrivee-e.debut},pst:function(t){var e=this.postes.find(function(e){return e.posteId===t});return void 0===e||null===e?{points:null}:e},crs:function(t){var e=this.courses.find(function(e){return e.courseId===t});return void 0===e||null===e?{debut:null,arrivee:null}:e}}},d=f,p=(n("b9f2"),n("2877")),v=Object(p["a"])(d,c,o,!1,null,"75f3aae4",null),h=v.exports,m=n("514e"),b={components:{aTable:a["a"],aInput:u["a"],ParticipantDetails:h,aSelect:s["b"],aSelectOption:s["b"].Option},methods:{getUnite:function(t){return Object(m["d"])(t)},getSousUnite:function(t){return Object(m["c"])(t)}},computed:{annees:function(){var t=this.data.map(function(t){return t.naissance});return t.filter(function(e,n){return t.indexOf(e)===n}).sort(function(t,e){return parseInt(t,10)<parseInt(e,10)})},branches:function(){return m["b"]},unites:function(){var t=this,e=this.sousUnite.map(function(e){return t.getSousUnite(e).uid});return e.filter(function(t,n){return e.indexOf(t)===n}).sort(function(t,e){return parseInt(t,10)<parseInt(e,10)})},sousUnite:function(){var t=this.data.map(function(t){return t.unitId});return t.filter(function(e,n){return t.indexOf(e)===n}).sort(function(t,e){return parseInt(t,10)<parseInt(e,10)})},sexe:function(){var t=this,e=this.unites.map(function(e){return t.getUnite(e).sexe});return e.filter(function(t,n){return e.indexOf(t)===n}).sort(function(t,e){return parseInt(t,10)<parseInt(e,10)})},participants:function(){var t=this,e=this.data;return-1!==this.year&&(e=e.filter(function(e){return e.naissance===t.year})),-1!==this.subUnit&&(e=e.filter(function(e){return e.unitId===t.subUnit})),-1!==this.unit&&(e=e.filter(function(e){return t.getSousUnite(e.unitId).uid===t.unit})),-1!==this.xxx&&(e=e.filter(function(e){return t.getUnite(t.getSousUnite(e.unitId).uid).sexe===t.xxx})),-1!==this.branche&&(e=e.filter(function(e){return 10===t.branche?[1,2].includes(t.getUnite(t.getSousUnite(e.unitId).uid).bid):11===t.branche?[3,4].includes(t.getUnite(t.getSousUnite(e.unitId).uid).bid):t.getUnite(t.getSousUnite(e.unitId).uid).bid===t.branche})),this.search.length>0&&(e=e.filter(function(e){return e.prenom.toLowerCase().includes(t.search)||e.nom.toLowerCase().includes(t.search)||"".concat(e.dossard).includes(t.search)})),e},cls:function(){return[{title:"Dossard",dataIndex:"dossard",key:"dossard"},{title:"Nom",dataIndex:"nom",key:"nom"},{title:"Prénom",dataIndex:"prenom",key:"prenom"},{title:"Année",dataIndex:"naissance",key:"naissance"},{title:"Unité",dataIndex:null,scopedSlots:{customRender:"unite"}},{title:"Sous-Unité",dataIndex:null,scopedSlots:{customRender:"sousunite"}}].concat(this.columns)}},props:{data:{type:Array,required:!0},details:{type:Boolean,default:function(){return!0}},border:{type:Boolean,default:function(){return!0}},columns:{type:Array,default:function(){return[]}},scroll:{default:function(){return{}}}},data:function(){return{year:-1,subUnit:-1,unit:-1,xxx:-1,branche:-1,search:""}}},x=b,g=(n("7bc5"),Object(p["a"])(x,r,i,!1,null,"435896f6",null));e["a"]=g.exports},a4bb:function(t,e,n){t.exports=n("8aae")},acd1:function(t,e,n){"use strict";n.r(e);var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"d-flex"},[n("sub-menu",{attrs:{title:"Résultats",subtitle:"Calculateur des résultats",icon:"trophy",color:"#eadb0e"}},[n("p",{staticClass:"pr-1"},[t._v("Vous pouvez sélectionner les postes et courses qui doivent entrer en jeu dans le calcul du résultat")]),n("sub-menu-category",{attrs:{title:"Résultats"}}),n("a-radio-group",{model:{value:t.resulttype,callback:function(e){t.resulttype=e},expression:"resulttype"}},[n("a-radio",{attrs:{value:1}},[t._v("Participants")]),n("br"),n("a-radio",{attrs:{value:2}},[t._v("Sous-Unités")]),n("br"),n("a-radio",{attrs:{value:3}},[t._v("Unités")])],1),n("sub-menu-category",{staticClass:"mt-3",attrs:{title:"Courses"}}),t._l(t.$store.state.courses,function(e){return n("div",{key:e.id},[n("a-checkbox",{attrs:{"default-checked":!0},on:{change:function(n){return t.toggleCourse(n,e.id)}}},[t._v(t._s(e.nom))])],1)}),n("sub-menu-category",{staticClass:"mt-3",attrs:{title:"Postes"}}),t._l(t.$store.state.postes,function(e){return n("div",{key:e.id},[n("a-checkbox",{attrs:{"default-checked":!0},on:{change:function(n){return t.togglePoste(n,e.id)}}},[t._v(t._s(e.nom))])],1)}),n("sub-menu-category",{staticClass:"mt-3",attrs:{title:"Autres paramètres"}}),n("a-checkbox",{attrs:{"default-checked":!0},on:{change:function(e){t.midcols=!t.midcols}}},[t._v("Colonnes intermédiaires")])],2),n("div",{staticClass:"fwidth"},[t._m(0),n(t.getComposant,{tag:"component",attrs:{postes:t.postes,courses:t.courses,midcols:t.midcols}})],1)],1)},i=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"p-3"},[n("h1",[t._v("Résultats")])])}],s=(n("ac6a"),n("96cf"),n("3b8d")),u=(n("20c5"),n("bb76")),a=(n("4bbf"),n("59a5")),c=n("8a52"),o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("h4",{staticClass:"item-category mb-1"},[t._v(t._s(t.title))])])},l=[],f={props:["title"]},d=f,p=(n("1d44"),n("2877")),v=Object(p["a"])(d,o,l,!1,null,"3755cfa1",null),h=v.exports,m=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("participants-liste",{attrs:{data:t.resultats,columns:t.columns}})],1)},b=[],x=(n("55dd"),n("6762"),n("2fdb"),n("7514"),n("147d")),g=n("9e13"),_=n("4b2f"),I=n("b5ad"),y=n("69da"),O={components:{ParticipantsListe:g["a"]},mounted:function(){var t=Object(s["a"])(regeneratorRuntime.mark(function t(){var e,n,r;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,_["a"].findAll();case 2:return e=t.sent,t.next=5,I["a"].findAll();case 5:return n=t.sent,t.next=8,y["a"].findAll();case 8:r=t.sent,this.participants=e.map(function(t){return t.courses=n.filter(function(e){return e.participantId===t.id}).filter(function(t){return null!==t.debut&&null!==t.arrivee}),t.postes=r.filter(function(e){return e.participantId===t.id}).filter(function(t){return null!==t.points}),t});case 10:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),data:function(){return{participants:[]}},props:["courses","postes","midcols"],methods:{diff:function(t){return Object(x["a"])(t.arrivee)-Object(x["a"])(t.debut)}},computed:{columns:function(){var t=[];if(this.midcols){var e=this.$store.state,n=e.courses,r=e.postes,i=this.courses.map(function(t){return{title:"Course ".concat(n.find(function(e){return e.id===t}).nom," (coeff: ").concat(n.find(function(e){return e.id===t}).coefficient,")"),customRender:function(e){var n=e.courses.find(function(e){return e.courseId===t});return n?Object(x["d"])([n.arrivee,n.debut]):"-"}}}),s=this.postes.map(function(t){return{title:"Poste ".concat(r.find(function(e){return e.id===t}).nom," (coeff: ").concat(r.find(function(e){return e.id===t}).coefficient,")"),customRender:function(e){var n=e.postes.find(function(e){return e.posteId===t});return n?n.points:"-"}}});t=t.concat(i).concat(s)}return this.postes.length>0&&t.push({title:"Points pondérés",customRender:function(t){return t.points}}),this.courses.length>0&&t.push({title:"Temps pondéré",customRender:function(t){return Object(x["c"])(t.temps)}}),(this.courses.length>0||this.postes.length>0)&&t.push({title:"Score final",customRender:function(t){return t.total}}),t},resultats:function(){var t=this,e=this.$store.state.postes,n=this.$store.state.courses,r=this.courses,i=this.postes;if(0===r.length&&0===i.length)return[];var s=this.participants,u=i.map(function(t){return e.find(function(e){return e.id===t})}).reduce(function(t,e){return t+parseInt(e.max,10)*parseInt(e.coefficient,10)},0);return s=s.filter(function(t){return r.every(function(e){return t.courses.map(function(t){return t.courseId}).includes(e)})}),s=s.filter(function(t){return i.every(function(e){return t.postes.map(function(t){return t.posteId}).includes(e)})}),s=s.map(function(s){return s.points=s.postes.filter(function(t){return i.includes(t.posteId)}).reduce(function(t,n){return t+n.points*e.find(function(t){return t.id===n.posteId}).coefficient},0),s.temps=s.courses.filter(function(t){return r.includes(t.courseId)}).reduce(function(e,r){return e+t.diff(r)*n.find(function(t){return t.id===r.courseId}).coefficient},0),s.total=s.temps+u-s.points,s}),s.sort(function(t,e){return t.total>e.total})}}},U=O,k=Object(p["a"])(U,m,b,!1,null,null,null),w=k.exports,S=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{staticClass:"container-fluid"},[n("div",{staticClass:"row mb-3"},[n("div",{staticClass:"col-3"},[t._v("\n                Bonus en secondes par participant\n                "),n("a-input",{attrs:{placeholder:"Bonus en secondes"},model:{value:t.bonusSeconds,callback:function(e){t.bonusSeconds=e},expression:"bonusSeconds"}})],1),n("div",{staticClass:"col-3"},[t._v("\n                Nombre min de participants\n                "),n("a-input",{attrs:{placeholder:"Nombre min de participants"},model:{value:t.minParticipants,callback:function(e){t.minParticipants=e},expression:"minParticipants"}})],1)]),n("div",{staticClass:"row mb-3"},[n("div",{staticClass:"col-12 col-md-3"},[t._v("\n                Filtrer par sexe\n                "),n("a-select",{staticStyle:{width:"100%"},model:{value:t.sexe,callback:function(e){t.sexe=e},expression:"sexe"}},[n("a-select-option",{attrs:{value:-1}},[t._v("Ne pas filtrer")]),t._l(["homme","femme"],function(e){return n("a-select-option",{key:e,attrs:{value:e}},[t._v(t._s(e))])})],2)],1)])]),n("a-table",{attrs:{columns:t.columns,dataSource:t.resultatsSousUnites,rowKey:"id"}})],1)},j=[],R=n("268f"),C=n.n(R),E=n("e265"),P=n.n(E),A=n("a4bb"),$=n.n(A),N=n("85f2"),F=n.n(N);function D(t,e,n){return e in t?F()(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function M(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},r=$()(n);"function"===typeof P.a&&(r=r.concat(P()(n).filter(function(t){return C()(n,t).enumerable}))),r.forEach(function(e){D(t,e,n[e])})}return t}n("a71a");var T=n("b558"),L=(n("02cf"),n("9839")),J=(n("0723"),n("0020")),B=n("514e"),H={components:{aTable:J["a"],aSelect:L["b"],aSelectOption:L["b"].Option,aInput:T["a"]},mounted:function(){var t=Object(s["a"])(regeneratorRuntime.mark(function t(){var e,n,r;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,_["a"].findAll();case 2:return e=t.sent,t.next=5,I["a"].findAll();case 5:return n=t.sent,t.next=8,y["a"].findAll();case 8:r=t.sent,this.participants=e.map(function(t){return t.courses=n.filter(function(e){return e.participantId===t.id}).filter(function(t){return null!==t.debut&&null!==t.arrivee}),t.postes=r.filter(function(e){return e.participantId===t.id}).filter(function(t){return null!==t.points}),t});case 10:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),data:function(){return{sexe:-1,bonusSeconds:50,minParticipants:2,participants:[],columns:[{title:"Sous unité",customRender:function(t){return t.sousUnite.nom}},{title:"Unité",customRender:function(t){return t.unite.nom}},{title:"Participants valables",customRender:function(t){return t.participants.length}},{title:"Score final",dataIndex:"total"}]}},props:["courses","postes","midcols"],methods:{getUnite:function(t){return Object(B["d"])(t)},getSousUnite:function(t){return Object(B["c"])(t)},diff:function(t){return Object(x["a"])(t.arrivee)-Object(x["a"])(t.debut)}},computed:{unites:function(){var t=this,e=this.sousUnite.map(function(e){return t.getSousUnite(e).uid});return e.filter(function(t,n){return e.indexOf(t)===n}).sort(function(t,e){return parseInt(t,10)<parseInt(e,10)})},sousUnite:function(){var t=this,e=this.resultats.map(function(t){return t.unitId});return e=e.filter(function(t,n){return e.indexOf(t)===n}).sort(function(t,e){return parseInt(t,10)<parseInt(e,10)}),-1!==this.sexe&&(e=e.filter(function(e){return t.getUnite(t.getSousUnite(e).uid).sexe===t.sexe})),e},resultatsSousUnites:function(){var t=this,e=""===this.bonusSeconds?0:parseInt(this.bonusSeconds,10),n=""===this.minParticipants?0:parseInt(this.minParticipants,10);return this.sousUnite.map(function(e){return{id:e,sousUnite:t.getSousUnite(e),participants:t.resultats.filter(function(t){return t.unitId===e})}}).map(function(e){return M({},e,{unite:t.getUnite(e.sousUnite.uid),total:e.participants.reduce(function(t,e){return t+e.total},0)})}).map(function(t){return M({},t,{bonus:t.participants.length*e})}).map(function(t){return M({},t,{total:Math.round((t.total-t.bonus)/t.participants.length)})}).filter(function(t){return t.participants.length>=n}).sort(function(t,e){return t.total>e.total})},resultats:function(){var t=this,e=this.$store.state.postes,n=this.$store.state.courses,r=this.courses,i=this.postes;if(0===r.length&&0===i.length)return[];var s=this.participants,u=i.map(function(t){return e.find(function(e){return e.id===t})}).reduce(function(t,e){return t+parseInt(e.max,10)*parseInt(e.coefficient,10)},0);return s=s.filter(function(t){return r.every(function(e){return t.courses.map(function(t){return t.courseId}).includes(e)})}),s=s.filter(function(t){return i.every(function(e){return t.postes.map(function(t){return t.posteId}).includes(e)})}),s=s.map(function(s){return s.points=s.postes.filter(function(t){return i.includes(t.posteId)}).reduce(function(t,n){return t+n.points*e.find(function(t){return t.id===n.posteId}).coefficient},0),s.temps=s.courses.filter(function(t){return r.includes(t.courseId)}).reduce(function(e,r){return e+t.diff(r)*n.find(function(t){return t.id===r.courseId}).coefficient},0),s.total=s.temps+u-s.points,s}),s.sort(function(t,e){return t.total>e.total})}}},W=H,K=Object(p["a"])(W,S,j,!1,null,null,null),q=K.exports,G=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{staticClass:"container-fluid"},[n("div",{staticClass:"row mb-3"},[n("div",{staticClass:"col-12 col-md-3"},[t._v("\n                Filtrer par sexe\n                "),n("a-select",{staticStyle:{width:"100%"},model:{value:t.sexe,callback:function(e){t.sexe=e},expression:"sexe"}},[n("a-select-option",{attrs:{value:-1}},[t._v("Ne pas filtrer")]),t._l(["homme","femme"],function(e){return n("a-select-option",{key:e,attrs:{value:e}},[t._v(t._s(e))])})],2)],1)])]),n("a-table",{attrs:{columns:t.columns,dataSource:t.resultatsUnites,rowKey:"id"}})],1)},z=[],V={components:{aTable:J["a"],aSelect:L["b"],aSelectOption:L["b"].Option},mounted:function(){var t=Object(s["a"])(regeneratorRuntime.mark(function t(){var e,n,r;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,_["a"].findAll();case 2:return e=t.sent,t.next=5,I["a"].findAll();case 5:return n=t.sent,t.next=8,y["a"].findAll();case 8:r=t.sent,this.participants=e.map(function(t){return t.courses=n.filter(function(e){return e.participantId===t.id}).filter(function(t){return null!==t.debut&&null!==t.arrivee}),t.postes=r.filter(function(e){return e.participantId===t.id}).filter(function(t){return null!==t.points}),t});case 10:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),data:function(){return{sexe:-1,participants:[],columns:[{title:"Unité",customRender:function(t){return t.unite.nom}},{title:"Participants comptabilisés",dataIndex:"participants"},{title:"Score final",dataIndex:"total"}]}},props:["courses","postes","midcols"],methods:{getUnite:function(t){return Object(B["d"])(t)},getSousUnite:function(t){return Object(B["c"])(t)},diff:function(t){return Object(x["a"])(t.arrivee)-Object(x["a"])(t.debut)}},computed:{unites:function(){var t=this,e=this.sousUnite.map(function(e){return t.getSousUnite(e).uid});return e.filter(function(t,n){return e.indexOf(t)===n}).sort(function(t,e){return parseInt(t,10)<parseInt(e,10)})},sousUnite:function(){var t=this,e=this.resultats.map(function(t){return t.unitId});return e=e.filter(function(t,n){return e.indexOf(t)===n}).sort(function(t,e){return parseInt(t,10)<parseInt(e,10)}),-1!==this.sexe&&(e=e.filter(function(e){return t.getUnite(t.getSousUnite(e).uid).sexe===t.sexe})),e},resultatsUnites:function(){var t=this,e=this.resultatsSousUnites;return this.unites.map(function(n){return{unite:t.getUnite(n),sousUnites:e.filter(function(t){return t.unite.uid===n})}}).map(function(t){return M({},t,{participants:t.sousUnites.flatMap(function(t){return t.participants}).length})}).map(function(t){return M({},t,{total:Math.round(t.sousUnites.reduce(function(t,e){return t+e.total},0)/t.participants)})}).sort(function(t,e){return t.total>e.total})},resultatsSousUnites:function(){var t=this,e=this.sousUnite;return-1!==this.sexe&&(e=e.filter(function(e){return t.getUnite(t.getSousUnite(e).uid).sexe===t.sexe})),e.map(function(e){return{id:e,sousUnite:t.getSousUnite(e),participants:t.resultats.filter(function(t){return t.unitId===e})}}).map(function(e){return M({},e,{unite:t.getUnite(e.sousUnite.uid),total:e.participants.reduce(function(t,e){return t+e.total},0)})}).sort(function(t,e){return t.total>e.total})},resultats:function(){var t=this,e=this.$store.state.postes,n=this.$store.state.courses,r=this.courses,i=this.postes;if(0===r.length&&0===i.length)return[];var s=this.participants,u=i.map(function(t){return e.find(function(e){return e.id===t})}).reduce(function(t,e){return t+parseInt(e.max,10)*parseInt(e.coefficient,10)},0);return s=s.filter(function(t){return r.every(function(e){return t.courses.map(function(t){return t.courseId}).includes(e)})}),s=s.filter(function(t){return i.every(function(e){return t.postes.map(function(t){return t.posteId}).includes(e)})}),s=s.map(function(s){return s.points=s.postes.filter(function(t){return i.includes(t.posteId)}).reduce(function(t,n){return t+n.points*e.find(function(t){return t.id===n.posteId}).coefficient},0),s.temps=s.courses.filter(function(t){return r.includes(t.courseId)}).reduce(function(e,r){return e+t.diff(r)*n.find(function(t){return t.id===r.courseId}).coefficient},0),s.total=s.temps+u-s.points,s}),s.sort(function(t,e){return t.total>e.total})}}},Q=V,X=Object(p["a"])(Q,G,z,!1,null,null,null),Y=X.exports,Z=n("0a45"),tt=n("d6b7"),et={components:{SubMenu:c["a"],aRadioGroup:a["a"].Group,aRadio:a["a"],SubMenuCategory:h,aCheckbox:u["a"],Resultats:w,ResultatsUnites:Y},mounted:function(){var t=Object(s["a"])(regeneratorRuntime.mark(function t(){var e=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Z["a"].findAll();case 2:return t.next=4,tt["a"].findAll();case 4:this.$store.state.postes.forEach(function(t){e.postes.push(t.id)}),this.$store.state.courses.forEach(function(t){e.courses.push(t.id)});case 6:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),methods:{toggleCourse:function(t,e){var n=this.courses.indexOf(e);t.target.checked||-1===n||this.courses.splice(n,1),t.target.checked&&-1===n&&this.courses.push(e)},togglePoste:function(t,e){var n=this.postes.indexOf(e);t.target.checked||-1===n||this.postes.splice(n,1),t.target.checked&&-1===n&&this.postes.push(e)}},data:function(){return{courses:[],postes:[],midcols:!0,resulttype:1}},computed:{getComposant:function(){return 1===this.resulttype?w:2===this.resulttype?q:Y}}},nt=et,rt=(n("5217"),Object(p["a"])(nt,r,i,!1,null,"032dee95",null));e["default"]=rt.exports},b9f2:function(t,e,n){"use strict";var r=n("35ac"),i=n.n(r);i.a},bf90:function(t,e,n){var r=n("36c3"),i=n("bf0b").f;n("ce7e")("getOwnPropertyDescriptor",function(){return function(t,e){return i(r(t),e)}})},c11f:function(t,e,n){},c62a:function(t,e,n){"use strict";var r=n("3496"),i=n.n(r);i.a},d6b7:function(t,e,n){"use strict";n("ac6a"),n("55dd"),n("6762"),n("2fdb"),n("96cf");var r=n("3b8d"),i=n("d225"),s=n("b0b4"),u=n("308d"),a=n("6bb5"),c=n("2a88"),o=n("4e2b"),l=n("bd67"),f=n("c0d6"),d=n("17e1"),p=n("4b2f"),v=n("147d"),h=["nom","coefficient"],m=function(t){function e(){var t;return Object(i["a"])(this,e),t=Object(u["a"])(this,Object(a["a"])(e).call(this)),t.nom=null,t.coefficient=null,t}return Object(o["a"])(e,t),Object(s["a"])(e,[{key:"insert",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(c["a"])(Object(a["a"])(e.prototype),"insert",this).call(this);case 2:return t.next=4,e.findAll();case 4:case"end":return t.stop()}},t,this)}));function n(){return t.apply(this,arguments)}return n}()},{key:"participantsPasFini",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark(function t(){var e,n,r;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,d["f"].run("SELECT * FROM ".concat(d["c"]," p JOIN ").concat(d["b"]," c ON c.participantId = p.id WHERE c.courseId = ?"),[this.id]);case 2:return e=t.sent,n=e.filter(function(t){return null!==t.debut&&null!==t.arrivee}).map(function(t){return t.participantId}),t.next=6,p["a"].findAll();case 6:return r=t.sent,t.abrupt("return",r.filter(function(t){return!n.includes(t.id)}));case 8:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}()},{key:"getResultats",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,d["f"].run("SELECT * FROM ".concat(d["c"]," p JOIN ").concat(d["b"]," c ON c.participantId = p.id WHERE c.courseId = ?"),[this.id]);case 2:return e=t.sent,t.abrupt("return",e.filter(function(t){return null!==t.debut&&null!==t.arrivee}).sort(function(t,e){return Object(v["a"])(t.arrivee)-Object(v["a"])(t.debut)>Object(v["a"])(e.arrivee)-Object(v["a"])(e.debut)}).map(function(t){var e=p["a"].convert(t);return e.id=t.participantId,e.temps=Object(v["d"])([t.arrivee,t.debut]),e}));case 4:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}()}],[{key:"findAll",value:function(){return Object(c["a"])(Object(a["a"])(e),"findAll",this).call(this).then(function(t){return f["a"].commit("cleanCourses"),t.forEach(function(t){f["a"].commit("addCourse",t)}),t})}}]),e}(l["a"]);m.table=d["a"],m.properties=h,e["a"]=m},e265:function(t,e,n){t.exports=n("ed33")},ed33:function(t,e,n){n("014b"),t.exports=n("584a").Object.getOwnPropertySymbols},fde4:function(t,e,n){n("bf90");var r=n("584a").Object;t.exports=function(t,e){return r.getOwnPropertyDescriptor(t,e)}}}]);
//# sourceMappingURL=resultats.997a5416.js.map